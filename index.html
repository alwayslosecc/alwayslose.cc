<script>
    // Request a new license key from the server
    async function generateLicenseKey() {
        try {
            const response = await fetch('http://localhost:3000/generate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            });
            const data = await response.json();
            document.getElementById("licenseKey").value = data.key;
        } catch (error) {
            alert("Failed to generate license key. Please try again.");
        }
    }

    // Mark the displayed key as used on the server
    async function useLicenseKey() {
        const key = document.getElementById("licenseKey").value;
        if (!key) return alert("No license key to use");

        try {
            const response = await fetch('http://localhost:3000/use-key', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ key })
            });
            const data = await response.json();
            if (data.message) alert(data.message);
            else alert(data.error);
        } catch (error) {
            alert("Failed to mark key as used. Please try again.");
        }
    }
</script>
